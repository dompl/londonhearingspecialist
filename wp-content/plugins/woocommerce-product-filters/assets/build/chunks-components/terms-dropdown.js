"use strict";(self.webpackChunkwoocommerce_filters=self.webpackChunkwoocommerce_filters||[]).push([[2771],{5959:function(e,t,n){n.r(t);var s=n(9307),o=n(9196),r=n.n(o),c=n(598),l=n(2819),a=n(544),u=n(5236),i=n(7536),f=n(374),d=n(9950),m=n(389),p=n(4271),g=n(4184),h=n.n(g),E=n(4376);const v=WCF_Frontend,b=(0,p.zo)();t.default=e=>{let{name:t,value:n,setValue:g,options:w,group:y,..._}=e;const{watch:k,resetField:C}=(0,i.Gc)(),S="yes"===v.filter_num_products,{layout:F}=_,{getGroup:L,getStoredValue:R,getInitialCounts:B,counts:V,prefilledValues:z,setPrefilling:A,submittedValues:I}=(0,m.CR)(),[O,G]=(0,o.useState)(!1),H=r().useRef(null),M=R(y,t),N=k(t,M),[T,U]=(0,o.useState)(M),[Y,Z]=(0,o.useState)([]),[j,D]=(0,o.useState)([]),P=(0,E.Lm)()<960,[W]=(0,a.I)((()=>{O&&G(!1)})),q=L(y),x=!!(0,l.has)(q,"data."+_.facet.slug)&&(0,o.useMemo)((()=>q.data[_.facet.slug]),[q.data[_.facet.slug]]);if(!x)return(0,s.createElement)(s.Fragment,null,b.no_terms);const J=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;(0,l.forEach)(e,((e,n)=>{let s=e.label,o="";t&&(o=Array(2*t+1).join(" ")+"– "),s=o+s,j.push({label:s,id:e.id,slug:e.slug}),(0,l.has)(e,"children")&&Array.isArray(e.children)&&J(e.children,t+1,!1)}))};(0,u.H)((function(){J(x);const e=R(y,t);if(!(0,l.isEmpty)(e)){const t=(0,p.w8)(x,e);(0,l.isEmpty)(t)||U([t])}const n=B(t);(0,l.has)(V,t)?Z(V[t]):Z(n)})),(0,o.useEffect)((()=>{const e=N;if((0,l.isUndefined)(e)||!1===e)U([]);else if(!(0,l.isUndefined)(e)&&!1!==e){const t=(0,p.w8)(x,e);t?.id&&U([t])}}),[N]),(0,o.useEffect)((()=>{if((0,l.has)(z,t)){const e=(0,p.w8)(x,z[t].toString());(0,l.isEmpty)(e)||(A(!0),g(t,e.id.toString()),A(!1))}}),[z]),(0,o.useEffect)((()=>{(0,l.has)(I,t)||!0!==_.mobile||(A(!0),C(t),A(!1))}),[I]),(0,o.useEffect)((()=>((0,m.BB)(Z,t),p.YB.on("filterToggled-"+t,(e=>{A(!0),g(t,[]),C(t),U(""),A(!1)})),()=>{p.YB.remove("filterToggled-"+t)})),[]),(0,f.Z)("wcf-reset-filters",(()=>{A(!0),g(t,!1),U(""),A(!1)}));const K=(e=>{const t=[];return(0,l.isEmpty)(Y)?[]:((0,l.forEach)(e,((e,n)=>{const s=Y.find((t=>t.facet_value===e?.slug));0!==(s?.counter||0)&&t.push(e)})),t)})(j),Q=h()("wcf-dropdown-wrapper",{"is-active":!(0,l.isEmpty)(T)}),X=v.searchable_mobile;return(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{ref:W,className:Q},(0,s.createElement)(c.Z,{options:K,value:T,placeholder:(0,l.isEmpty)(K)?b.no_options:_.label,onChange:e=>(e=>{const n=(0,l.map)(e,"id");U(e),g(t,n[0])})(e.value),searchable:P&&X,overrides:"horizontal"===F?d.Rd:d.Hz,noResultsMsg:b.no_results,getOptionLabel:e=>{let{option:t}=e,n=0;const o=Y.find((e=>e.facet_value===t?.slug));return n=o?.counter||0,(0,s.createElement)(s.Fragment,null,t.label,S&&(0,s.createElement)("span",{className:"wcf-choices-counter"},"(",n,")"))},clearable:!1,disabled:(0,l.isEmpty)(K),controlRef:H,onOpen:()=>{O?(H.current.setDropdownOpen(!1),G(!1)):G(!0)}})))}},544:function(e,t,n){n.d(t,{I:function(){return r}});var s=function(){},o=n(9196);function r(e,t){void 0===t&&(t=!0);var n=(0,o.useRef)(e),r=(0,o.useState)(null),c=r[0],l=r[1],a=(0,o.useCallback)((function(e){c&&!c.contains(e.target)&&n.current(e)}),[c]);(0,o.useEffect)((function(){n.current=e}));var u=(0,o.useCallback)((function(e){l(e)}),[]);return(0,o.useEffect)((function(){return t?(document.addEventListener("click",a,!0),document.addEventListener("ontouchstart",a,!0),function(){document.removeEventListener("click",a,!0),document.removeEventListener("ontouchstart",a,!0)}):s}),[t,a]),[u]}}}]);
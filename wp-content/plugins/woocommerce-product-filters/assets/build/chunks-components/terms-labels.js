"use strict";(self.webpackChunkwoocommerce_filters=self.webpackChunkwoocommerce_filters||[]).push([[9908],{8186:function(e,t,a){a.r(t);var s=a(9307),l=a(9196),o=a(2819),r=a(1075),n=a(907),i=a(5236),c=a(2629),u=a(7536),m=a(374),d=a(9950),g=a(389),f=a(4271);const p=(0,s.lazy)((()=>a.e(1172).then(a.bind(a,4230)).then((e=>({default:e.Button}))))),h=(0,s.lazy)((()=>a.e(9286).then(a.bind(a,2489)).then((e=>({default:e.ButtonGroup}))))),y=(0,s.lazy)((()=>a.e(7683).then(a.bind(a,521)))),E=WCF_Frontend,b=(0,f.zo)();t.default=e=>{let{name:t,value:a,options:w,group:S,..._}=e;const{watch:A,setValue:v}=(0,u.Gc)(),k="yes"===E.filter_num_products,[z,B]=(0,l.useState)(12),{submittedValues:V,getGroup:C,getStoredValue:F,getInitialCounts:M,counts:I,prefilledValues:N,setPrefilling:q}=(0,g.CR)(),G=F(S,t),T=A(t,G),[Y,L]=((0,n.q)(T),(0,l.useState)(Array.isArray(G)?G:[])),[x,H]=(0,l.useState)(!0),[O,P]=(0,l.useState)([]),R=C(S),W=!!(0,o.has)(R,"data."+_.facet.slug)&&(0,l.useMemo)((()=>R.data[_.facet.slug]),[R.data[_.facet.slug]]);if(!W)return(0,s.createElement)(s.Fragment,null,b.no_terms);(0,i.H)((async()=>{const e=M(t);e&&P(e),(0,o.has)(I,t)&&P(I[t]),"horizontal"===_.layout&&(await(0,f.f6)(B,5,t),(0,o.has)(V,t)&&L(Array.isArray(V[t])?V[t].map(String):[]))})),(0,l.useEffect)((()=>{(0,o.has)(N,t)&&!(0,o.isEqual)(N[t],T)&&(0,o.isEmpty)(T)&&(q(!0),v(t,N[t].map(String)),q(!1),console.log("doing prefilling"))}),[N]),(0,l.useEffect)((()=>{"horizontal"!==_.layout&&(console.log("detecting counts upate"),(0,g.BB)(P,t,{method:H,itemsAmount:12,mobile:_?.mobile}))}),[]),(0,l.useEffect)((()=>{if((0,o.has)(V,t)&&!0===_.mobile){const e=V[t].map(String);console.log("checking submittedValues 1stage"),(0,o.isEqual)(e,Y)||(q(!0),v(t,e),q(!1),console.log("checking submittedValues 2stage"))}}),[V]),(0,l.useEffect)((()=>(f.YB.on("filterToggled-"+t,(e=>{console.log("filterToggled",e),q(!0),v(t,Array.isArray(e.value)?e.value.map(String):[]),L(Array.isArray(e.value)?e.value.map(String):[]),q(!1)})),()=>{f.YB.remove("filterToggled-"+t)})),[]),(0,m.Z)("wcf-reset-filters",(()=>{console.log("resetting filters"),q(!0),v(t,[]),L([]),q(!1)}));const Z=(0,f.V9)(W,O),j=!0===x||!0===_?.mobile?Z.slice(0,z):Z,D=Array.isArray(Z)?parseInt(Z.length):0;return(0,o.isEmpty)(j)?(0,s.createElement)("span",{className:"wcf-no-options-label"},b.no_options):(0,s.createElement)(s.Fragment,null,(0,s.createElement)("div",{id:"wcf-items-container-"+t},(0,s.createElement)(h,{overrides:d.BY,size:r.NO.compact,mode:"checkbox",selected:Y,onClick:(e,a)=>{let s=[],l=e.target.dataset.termId;(0,o.isEmpty)(l)&&(l=e.target.parentElement.dataset.termId),s=Y.includes(l)?Y.filter((e=>e!==l)):[...Y,l],L(s),v(t,s)}},j.map((e=>(0,s.createElement)(p,{key:e.term_id,isSelected:Y.includes(Number.isFinite(e.term_id)?e.term_id.toString():e.term_id),type:"button","data-term-id":e.term_id,overrides:d.w9},(0,c.decodeEntities)(e.name),k&&(0,s.createElement)("span",{className:"wcf-choices-counter"},"(",e.count,")"))))),(0,s.createElement)(y,{displayShowMore:D>z,showMoreMethod:()=>B(D),displayShowLess:z>12,showLessMethod:()=>B(12)})))}}}]);